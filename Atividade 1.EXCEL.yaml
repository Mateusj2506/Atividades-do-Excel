name: Atividade 1
description: ''
host: EXCEL
api_set: {}
script:
  content: "const format = document.getElementById(\"formatar\") as HTMLButtonElement;\r\nformat.addEventListener(\"click\", async () => {\r\n  await Excel.run(async (context) => {\r\n    const sheet = context.workbook.worksheets.getActiveWorksheet();\r\n    sheet.getRange().clear();\r\n    sheet.name = \"Primeira Atividade\";\r\n\r\n    const range = sheet.getRange(\"A1:B9\");\r\n    range.values = [\r\n      [\"Insira\", \"\"],\r\n      [\"numero 1: \", \"\"],\r\n      [\"numero 2: \", \"\"],\r\n      [\"numero 3: \", \"\"],\r\n      [\"numero 4: \", \"\"],\r\n      [\"numero 5: \", \"\"],\r\n      [\"Resposta\", \"\"],\r\n      [\"Num maior: \", \"\"],\r\n      [\"Num menor: \", \"\"]\r\n    ];\r\n\r\n    range.format.borders.getItem(\"InsideHorizontal\").color = \"Black\";\r\n    range.format.borders.getItem(\"InsideVertical\").color = \"Black\";\r\n    range.format.borders.getItem(\"EdgeTop\").color = \"Black\";\r\n    range.format.borders.getItem(\"EdgeLeft\").color = \"Black\";\r\n    range.format.borders.getItem(\"EdgeRight\").color = \"Black\";\r\n    range.format.borders.getItem(\"EdgeBottom\").color = \"Black\";\r\n\r\n    sheet.getRange(\"A1:A9\").format.font.bold = true;\r\n    sheet.getRange(\"A1:A9\").format.fill.color = \"#FFFACD\";\r\n    sheet.getRange(\"A1:B1\").merge();\r\n    sheet.getRange(\"A7:B7\").merge();\r\n    sheet.getRange(\"A1:B1\").format.horizontalAlignment = \"right\";\r\n    sheet.getRange(\"A7:B7\").format.horizontalAlignment = \"right\";\r\n\r\n    const effectuation = \"#.##0\";\r\n    sheet.getRange(\"B8:B9\").numberFormat = [[effectuation], [effectuation]];\r\n    sheet.getRange(\"B2:B6\").numberFormat = [\r\n      [effectuation],\r\n      [effectuation],\r\n      [effectuation],\r\n      [effectuation],\r\n      [effectuation]\r\n    ];\r\n  });\r\n});\r\n\r\nconst execute = document.getElementById(\"executar\") as HTMLButtonElement;\r\nexecute.addEventListener(\"click\", async () => {\r\n  await Excel.run(async (context) => {\r\n    const sheet = context.workbook.worksheets.getActiveWorksheet();\r\n\r\n    let extension = sheet.getRange(\"B2\");\r\n    extension.load(\"values\");\r\n    await context.sync();\r\n\r\n    let numeroPrimario = parseFloat(extension.values[0][0]);\r\n\r\n    let maior = numeroPrimario,\r\n      menor = numeroPrimario;\r\n\r\n    let extensionNum = sheet.getRange(`B3:B6`);\r\n    extensionNum.load(\"values\");\r\n    await context.sync();\r\n\r\n    for (let i = 0; i < 4; i++) {\r\n      let numero = extensionNum.values[i][0];\r\n      if (numero > maior) {\r\n        maior = numero;\r\n      }\r\n      if (numero < menor) {\r\n        menor = numero;\r\n      }\r\n    }\r\n\r\n    let extensionMaiorMenor = sheet.getRange(\"B8:B9\");\r\n    extensionMaiorMenor.load(\"values\");\r\n    await context.sync();\r\n\r\n    extensionMaiorMenor.values = [[maior], [menor]];\r\n    await context.sync();\r\n  });\r\n});\r\n"
  language: typescript
template:
  content: "<p>Execute a tabela:</p><br>\n<button id=\"formatar\">Preparar</button><br>\n<p>Click no botao executar para ver os resultados <p>\n\t\t<button id=\"executar\">executar</button>"
  language: html
style:
  content: ''
  language: css
libraries: |
  https://appsforoffice.microsoft.com/lib/1/hosted/office.js
  @types/office-js

  core-js@2.4.1/client/core.min.js
  @types/core-js
